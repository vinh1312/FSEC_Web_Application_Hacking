# Phân tích và đánh giá lỗ hổng IDOR: Mối đe dọa tiềm ẩn cho an ninh mạng

<small>*Ngày cập nhật: 22 tháng 5, 2024 - 15:30*</small>

## Nội dung chính:
[I. Định nghĩa về IDOR](#definition-of-idor)

[II. Lỗ hổng IDOR với tham chiếu trực tiếp đến đối tượng cơ sở dữ liệu](#idor-vulnerability-with-direct-reference-to-database-object)

[III. lỗ hổng IDOR với tham chiếu trực tiếp đến tệp tin tĩnh](#idor-vulnerability-with-direct-reference-to-static-file)

[IV. Nguyên nhân và hậu quả của lỗ hổng IDOR (Insecure Direct Object Reference)](#causes-and-consequences-of-idor-vulnerability)

[V. Khai thác lỗi IDOR (Insecure Direct Object Reference)](#exploit-idor-bug)
- [1. Kiểm tra thủ công lỗi IDOR](#manually-check-for-idor-errors)
- [2. Sử dụng Burp Suite để kiểm tra lỗi IDOR](#use-burp-suite-to-check-idor-errors)

[VI. Cách ngăn chặn lỗi IDOR (Insecure Direct Object Reference)](#how-to-prevent-idor-errors)

<a name="definition-of-idor"></a>
## I. Định nghĩa về IDOR:

`IDOR` là viết tắt của `Insecure Direct Object Reference`, hay `Tham chiếu đối tượng trực tiếp không an toàn`. Đây là một loại lỗ hổng bảo mật thường gặp trong các ứng dụng web, xảy ra khi ứng dụng sử dụng đầu vào do người dùng cung cấp để truy cập trực tiếp vào các đối tượng (như tệp tin, bản ghi cơ sở dữ liệu) mà không có bất kỳ biện pháp xác minh bổ sung nào. 

Hiểu đơn giản như việc chúng ta có một chìa khóa dùng để mở hòm thư số 4, nhưng thay vì chỉ mở được hòm thư số 4 thì nó lại có thể mở được cả những hòm thư khác mà không riêng gì số 4. Như vậy tất cả hòm thư đều đã bị lỗi IDOR vì chúng ta có thể mở bất kì hòm thư nào bằng chìa khóa hiện tại. 

Thuật ngữ IDOR được biết đến rộng rãi kể từ khi xuất hiện trong [Top 10 lỗ hổng của OWASP năm 2007](https://owasp.org/www-chapter-belgium/assets/2007/2007-03-21/OWASP%20Intro%20and%20Top%2010%202007.pdf). Tuy nhiên, đây chỉ là một trong số nhiều lỗi triển khai kiểm soát truy cập có thể dẫn đến việc vượt qua các biện pháp kiểm soát. Lỗ hổng IDOR thường liên quan đến nâng cao `đặc quyền ngang bằng (horizontal privilege escalation)`, nhưng cũng có thể xảy ra với nâng cao `đặc quyền theo chiều dọc (vertical privilege escalation)`.

<a name="idor-vulnerability-with-direct-reference-to-database-object"></a>
## II. Lỗ hổng IDOR với tham chiếu trực tiếp đến đối tượng cơ sở dữ liệu:

Giả sử một trang web có chức năng cho phép người dùng xem thông tin hồ sơ của họ. Trang web sử dụng ID người dùng để truy cập bản ghi cơ sở dữ liệu tương ứng:
```
https://insecure-website.com/customer_account?customer_ID=132355

```
Chúng ta có thể thấy được rằng ID người dùng của chúng ta là `132355`, và nó trả về toàn bộ thông tin của mình. Chúng ta có thể xem toàn bộ thông tin của người dùng có ID là `122222` vì không có kiểm tra danh tính trước khi máy chủ trả về thông tin cá nhân của người dùng. Máy chủ đã không xác minh rằng trên thực tế, chúng ta là người dùng `122222` hay là kẻ mạo danh. Nó chỉ đơn giản là trả lại thông tin, như chúng ta đã yêu cầu tới website. Đây chính là ví dụ liên quan đến nâng cao **đặc quyền ngang bằng (horizontal privilege escalation)**.

<a name="idor-vulnerability-with-direct-reference-to-static-file"></a>
## III. lỗ hổng IDOR với tham chiếu trực tiếp đến tệp tin tĩnh:

lỗ hổng IDOR với tham chiếu trực tiếp đến tệp tin tĩnh **(Insecure Direct Object Reference with Static File Access)** là một lỗ hổng bảo mật web nghiêm trọng. Nó xảy ra khi ứng dụng web lưu trữ dữ liệu của người dùng trên hệ thống tập tin của máy chủ dưới dạng các `tệp tin tĩnh`, và sau đó cho phép truy cập đến các tệp tin này bằng cách sử dụng `URL trực tiếp`.

**Cách thức hoạt động:**

1. **Lưu trữ trực tiếp:** Ứng dụng lưu trữ dữ liệu người dùng, chẳng hạn như nhật ký trò chuyện, dưới dạng các tệp tin tĩnh trên hệ thống tập tin của máy chủ.
2. **URL tĩnh:** Ứng dụng sử dụng URL tĩnh, không được mã hóa hoặc xử lý an toàn, để truy cập và hiển thị các tệp tin này cho người dùng. Các URL này thường chứa một tham số hoặc phần tử đường dẫn xác định tệp tin cụ thể.
3. **Kiểm soát truy cập yếu:** Ứng dụng không thực hiện kiểm soát truy cập đủ mạnh để đảm bảo chỉ người dùng được phép mới có thể truy cập vào các tệp tin của họ. Kẻ tấn công có thể lợi dụng điều này để đoán hoặc thao túng đầu vào của URL để truy cập vào các tệp tin của người dùng khác.

Giả sử nhật ký trò chuyện được lưu trữ dưới dạng các tệp tin với tên dựa trên ID người dùng. URL để truy cập nhật ký trò chuyện của một người dùng có thể trông giống như:

```
https://www.example.com/logs/user_carlos.txt

```

Nếu ứng dụng không kiểm tra xem người dùng đang yêu cầu có phải là chủ sở hữu hợp pháp của nhật ký trò chuyện đó hay không, thì kẻ tấn công có thể thay đổi `carlos` thành ID người dùng khác (ví dụ: "maria") để xem nhật ký trò chuyện riêng tư của người dùng đó.

<a name="causes-and-consequences-of-idor-vulnerability"></a>
## IV. Nguyên nhân và hậu quả của lỗ hổng IDOR (Insecure Direct Object Reference):

### Nguyên nhân:

Lỗ hổng IDOR thường xuất phát từ những sai lầm trong việc triển khai kiểm soát truy cập của ứng dụng web. Các nguyên nhân phổ biến bao gồm:

* **Sử dụng trực tiếp đầu vào của người dùng để truy cập đối tượng:** Việc ứng dụng sử dụng ID người dùng, tên tệp hoặc các thông tin khác do người dùng cung cấp để truy cập trực tiếp vào các đối tượng mà không có kiểm tra xác minh là nguyên nhân chính dẫn đến lỗ hổng IDOR.
* **Thiếu kiểm soát truy cập dựa trên vai trò:** Ứng dụng không phân biệt người dùng dựa trên vai trò và quyền hạn, dẫn đến việc người dùng có thể truy cập trái phép vào các đối tượng mà họ không được phép.
* **Sử dụng mã định danh truy cập yếu:** Mã định danh truy cập được sử dụng để truy cập đối tượng không đủ mạnh hoặc có thể dự đoán được, khiến kẻ tấn công dễ dàng giả mạo để truy cập trái phép.

### Hậu quả:

Lỗ hổng IDOR có thể dẫn đến nhiều hậu quả nghiêm trọng cho ứng dụng web và người dùng, bao gồm:

* **Tiết lộ thông tin nhạy cảm:** Kẻ tấn công có thể truy cập vào thông tin cá nhân, dữ liệu tài chính hoặc các thông tin nhạy cảm khác của người dùng khác.
* **Sửa đổi dữ liệu:** Kẻ tấn công có thể sửa đổi hoặc xóa dữ liệu của người dùng khác, gây thiệt hại về tài chính hoặc ảnh hưởng đến danh tiếng.
* **Thực thi mã độc hại:** Kẻ tấn công có thể tải lên mã độc hại lên máy chủ và thực thi nó, gây ra thiệt hại về hệ thống hoặc đánh cắp dữ liệu.
* **Nâng cao đặc quyền:** Kẻ tấn công có thể lợi dụng lỗ hổng IDOR để nâng cao quyền hạn của họ trong ứng dụng, cho phép họ thực hiện các hành động trái phép mà thông thường họ không được phép.

**Ngoài ra, lỗ hổng IDOR còn có thể làm giảm uy tín của ứng dụng web và tổ chức, gây ảnh hưởng đến lòng tin của người dùng.**

<a name="exploit-idor-bug"></a>
## V. Khai thác lỗi IDOR (Insecure Direct Object Reference):

Để có thể gia cố trang web của chúng ta thêm chắc chắn, thì đều đầu tiên là phải tự mình tìm ra lỗ hổng trên hệ thống trước kẻ xấu và sửa chữa sớm nhất có thể, tránh hậu họa tổn thất nặng nề về sau.

<a name="manually-check-for-idor-errors"></a>
### 1. Kiểm tra thủ công lỗi IDOR:

- **Xác định điểm có thể kiểm tra IDOR**:
   - Tìm các tham số trong URL, các giá trị POST, hoặc bất kỳ tham số nào có thể tham chiếu đến một đối tượng cụ thể.

- **Thay đổi giá trị tham chiếu**:
   - Thay đổi giá trị của tham số để kiểm tra xem có thể truy cập hoặc thay đổi dữ liệu của đối tượng khác hay không. Ví dụ:
     ```
     http://example.com/user?id=12345 -> http://example.com/user?id=12346
     ```

- **Quan sát kết quả**:
   - Kiểm tra xem chúng ta có thể truy cập được vào thông tin của đối tượng khác hay không. Nếu có, đây là một dấu hiệu của lỗi IDOR.

<a name="use-burp-suite-to-check-idor-errors"></a>
### 2. Sử dụng Burp Suite để kiểm tra lỗi IDOR:

Chúng ta sẽ tìm hiểu một ví dụ đơn giản về việc trích xuất nhật ký trò chuyện của người dùng trực tiếp trên hệ thống tập tin của máy chủ và truy xuất chúng bằng các URL tĩnh. Mục tiêu là tìm mật khẩu của người dùng `carlos` và đăng nhập vào tài khoản của anh ấy.

- Sử dụng __Burp Suite__ để chặn yêu cầu HTTP khi chúng ta truy cập vào URL có tham số. Chúng ta sẽ thử với trang web [https://web-security-academy.net/](https://0a7a002e0423530b83e5611800750088.web-security-academy.net/).
<img src="https://private-user-images.githubusercontent.com/145733288/332861847-6430a1d1-b6e4-489c-8443-a6bc23898df5.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTYzOTI0MjQsIm5iZiI6MTcxNjM5MjEyNCwicGF0aCI6Ii8xNDU3MzMyODgvMzMyODYxODQ3LTY0MzBhMWQxLWI2ZTQtNDg5Yy04NDQzLWE2YmMyMzg5OGRmNS5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNTIyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDUyMlQxNTM1MjRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT01MDVmMjZkY2JlZTg0YTNlMTEyYzQxNjQ0YjcwNDM2MmU2NDU5YzJmMzRjZDA1N2I1ZmJkYjFjOGE0NmQwNDM3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.5fwbEmDeP338pbX71mwlUgSuvieUuyDsgLM-zZKxEo4">

- Khi chúng ta truy cập vào `Live chat` và bắt đầu nhắn tin, thì sẽ được phản hồi như trong ảnh. Tiếp theo chúng ta nhấn vào `View transcript` thì sẽ tải về một file có tên là `2.txt`.
<img src="https://private-user-images.githubusercontent.com/145733288/332863409-fd7183a2-8ae0-4722-ba1d-a8036b67bb35.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTYzOTI0ODMsIm5iZiI6MTcxNjM5MjE4MywicGF0aCI6Ii8xNDU3MzMyODgvMzMyODYzNDA5LWZkNzE4M2EyLThhZTAtNDcyMi1iYTFkLWE4MDM2YjY3YmIzNS5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNTIyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDUyMlQxNTM2MjNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jY2FjZGUxZTU5MTAyYTUyZjNmODA2MDc1MjgyNTkwMmJiMzUwZmQwMWJkNjhiYWFkOWY3OTE3MzAwMGM5YjM1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.ENF9RaD6TMxnzES1EFtA3O2W04iwhL-Ung5PXA0KxvU">

- Mở __Burp Suite__ và xem `Proxy\HTTP History`, chúng ta thấy được nó ghi lại thông tin URL để tải tệp tin chứa lịch sử chat của chúng ta lúc nãy như trong ảnh.
<img src="https://private-user-images.githubusercontent.com/145733288/332863832-321a6dc9-e4ef-4030-b36d-168f693c1508.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTYzOTI1NjQsIm5iZiI6MTcxNjM5MjI2NCwicGF0aCI6Ii8xNDU3MzMyODgvMzMyODYzODMyLTMyMWE2ZGM5LWU0ZWYtNDAzMC1iMzZkLTE2OGY2OTNjMTUwOC5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNTIyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDUyMlQxNTM3NDRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xMzRmMzY2MzJmNDEyNmU0MmJlNTZlNjNkY2E1YTQzYzJkNDZiMDNlMDFiOWU5YTcyNWJhZTI3NTZjYmNhMTYwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.QLoMd8UUp9k4b2GS8P1w5aEstm6QjOhZfvptuuseWks">

- Tiếp theo chúng ta thêm URL này vào tab `Repeater`, và sau đó nhấn `Send` thì bên phần `Response` chúng ta nhận được thông tin đoạn chat lúc nãy của chúng ta.
<img src="https://private-user-images.githubusercontent.com/145733288/332864144-17562806-d33c-420f-a3b1-e05b557f468f.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTYzOTI2MTksIm5iZiI6MTcxNjM5MjMxOSwicGF0aCI6Ii8xNDU3MzMyODgvMzMyODY0MTQ0LTE3NTYyODA2LWQzM2MtNDIwZi1hM2IxLWUwNWI1NTdmNDY4Zi5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNTIyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDUyMlQxNTM4MzlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wMWIxNDEzNDVjNGYzNmEwNGU0ODA4OWVkNzdhNDVkOWIwZDNjM2M1MmNiOTEyNWFhM2VlYTlmZjAzOWMxNmU5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.rVhN2eeq_BS0J_uqkdDrwKpoJwfjvAPCBhfau4xUMSY">

- Để ý thấy thông tin đoạn chat của chúng ta được lưu tại file có tên là "2.txt", nên có lẻ thông tin đoạn chat của user mà chúng ta cần tìm sẽ nằm ở "0.txt" hoặc "1.txt". Chúng ta sửa thông tin ở phần `Request`, đổi tên file thành "0.txt" như trong ảnh.
<img src="https://private-user-images.githubusercontent.com/145733288/332864416-c96b9a66-2397-4dc1-b284-65c0282e5dbe.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTYzOTI2NjUsIm5iZiI6MTcxNjM5MjM2NSwicGF0aCI6Ii8xNDU3MzMyODgvMzMyODY0NDE2LWM5NmI5YTY2LTIzOTctNGRjMS1iMjg0LTY1YzAyODJlNWRiZS5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNTIyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDUyMlQxNTM5MjVaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04NGJlNDFhOTc1ZDZjY2RhYzBhZmE0YjQ2Y2I1NWY2NjE1ZDEyMDBlNTJhNGFlZjExMWYwY2FmMGI2OGEwN2JmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.V_KZhXOoly_EJk04Haecu-6pVJbfVky9W44mHHC7iIE">

- Vì "0.txt" không tồn tại bất kì nội dung nào nên tiếp tục đổi tên thành "1.txt" và sau đó `Send`, thì ta nhận được thông tin đoạn chat như trong hình. Đoạn chat này chính là thứ ta cần tìm để có được mật khẩu của user `carlos`.
<img src="https://private-user-images.githubusercontent.com/145733288/332864659-1027c873-ba8b-4ca4-a41f-52c0dc645b39.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTYzOTI3MDgsIm5iZiI6MTcxNjM5MjQwOCwicGF0aCI6Ii8xNDU3MzMyODgvMzMyODY0NjU5LTEwMjdjODczLWJhOGItNGNhNC1hNDFmLTUyYzBkYzY0NWIzOS5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNTIyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDUyMlQxNTQwMDhaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mODIxYWYxYzZlMWZmODc5ZDU4Y2I1NTgzZWZlZjc5YTk2N2ExMTJkMTc3YzkyMjY3YzM1OWViY2RiMTZkY2U1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.gLlHZvhbNTJglslBp28-jok4MZI2ItsAe8LAeVJXRkw">

<a name="how-to-prevent-idor-errors"></a>
## VI. Cách ngăn chặn lỗi IDOR (Insecure Direct Object Reference):

Lỗi IDOR là một lỗ hổng bảo mật web nghiêm trọng có thể xảy ra khi ứng dụng web sử dụng đầu vào của người dùng để truy cập trực tiếp vào các đối tượng (như tệp tin, bản ghi cơ sở dữ liệu) mà không có biện pháp xác minh bổ sung. Kẻ tấn công có thể lợi dụng điều này để truy cập vào các đối tượng mà họ không được phép truy cập, hoặc để thực hiện các hành động trái phép.

**Đây là một số cách để ngăn chặn lỗi IDOR:**

1. **Sử dụng mã định danh truy cập mạnh:**

    * Thay vì sử dụng ID người dùng, tên tệp hoặc các thông tin do người dùng cung cấp để truy cập trực tiếp vào đối tượng, hãy sử dụng mã định danh truy cập ngẫu nhiên, khó đoán và có độ dài đủ lớn để bảo vệ các đối tượng.
    * Ví dụ: thay vì sử dụng `user_id=123` trong URL để truy cập hồ sơ của người dùng, hãy sử dụng mã định danh truy cập ngẫu nhiên như `user_token=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6`.

2. **Thực thi kiểm soát truy cập dựa trên vai trò:**

    * Phân biệt người dùng dựa trên vai trò và quyền hạn, chỉ cấp quyền truy cập vào các đối tượng mà họ cần thiết để thực hiện các tác vụ của mình.
    * Ví dụ: chỉ cho phép quản trị viên truy cập vào cài đặt quản trị, và chỉ cho phép người dùng truy cập vào hồ sơ của chính họ.

3. **Xác minh đầu vào của người dùng:**

    * Luôn kiểm tra và xác minh đầu vào của người dùng trước khi sử dụng nó để truy cập vào các đối tượng.
    * Ví dụ: đảm bảo rằng ID người dùng hợp lệ và tồn tại trước khi truy cập vào hồ sơ của họ.

4. **Sử dụng mã hóa:**

    * Mã hóa dữ liệu nhạy cảm khi lưu trữ và truyền tải để giảm thiểu nguy cơ bị đánh cắp.
    * Ví dụ: mã hóa mật khẩu người dùng và các thông tin nhạy cảm khác.

5. **Cập nhật phần mềm thường xuyên:**

    * Cài đặt các bản cập nhật bảo mật mới nhất cho phần mềm máy chủ và ứng dụng web để vá các lỗ hổng đã được phát hiện.

6. **Nâng cao nhận thức của nhân viên:**

    * Nâng cao nhận thức của nhân viên về các lỗ hổng bảo mật và hướng dẫn họ cách sử dụng các ứng dụng web một cách an toàn.

**Ví dụ:**

Giả sử một trang web cho phép người dùng tải tệp dựa trên tên tệp trong URL. Lỗ hổng IDOR có thể xảy ra nếu trang web không kiểm tra xem tên tệp có hợp lệ hay không. Kẻ tấn công có thể lợi dụng điều này để tải tệp độc hại lên máy chủ bằng cách thay đổi tên tệp trong URL.

Để ngăn chặn điều này, trang web có thể sử dụng mã định danh truy cập ngẫu nhiên cho mỗi tệp tin. Khi người dùng muốn tải tệp, họ sẽ được cung cấp mã định danh truy cập thay vì tên tệp. URL để tải tệp sẽ trông giống như:

```
https://www.example.com/download?file_token=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
```

Bằng cách này, kẻ tấn công không thể đoán hoặc thao túng tên tệp để tải tệp độc hại lên máy chủ.

Lỗ hổng __IDOR (Insecure Direct Object Reference)__ là một lỗ hổng bảo mật web nghiêm trọng có thể dẫn đến hậu quả nghiêm trọng như tiết lộ thông tin nhạy cảm, sửa đổi dữ liệu và giả mạo danh tính. Do đó, việc phòng ngừa lỗ hổng này là rất quan trọng. Bằng cách thực hiện các biện pháp phòng ngừa nêu trên, các nhà phát triển web có thể giúp giảm thiểu nguy cơ bị khai thác lỗ hổng IDOR và bảo vệ dữ liệu người dùng của họ. Ngoài ra, việc nâng cao nhận thức của người dùng về các lỗ hổng bảo mật và cách sử dụng internet một cách an toàn cũng đóng vai trò quan trọng trong việc bảo vệ an ninh mạng.